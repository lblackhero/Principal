@{
    ViewData["Title"] = "Inicio";
}

@model Equitool.Models.ModeloFacturacion

@if (User.Identity.IsAuthenticated)
{
    <!-- Page content-->
    <!-- Cards dashboard -->
    <div class="container-fluid px-5 pb-2 ">
        <div class="row">
            <div class="col-xl-3 col-lg-3 col-md-12">
                <div class="card-counter primary">
                    <i class="fa fa-code-fork"></i>
                    @if (Model.listaRegistros != null)
                    {
                        <span class="count-numbers">@Model.listaRegistros.Count()</span>
                        <span class="count-name">Envíos</span>
                    }
                    else
                    {
                        <span class="count-numbers">0</span>
                        <span class="count-name">Envíos</span>
                    }
                </div>
            </div>

            <div class="col-xl-3 col-lg-3 col-md-12">
                <div class="card-counter danger">
                    <i class="fa fa-ticket"></i>
                    @if (Model.listaRegistros != null)
                    {
                        <span class="count-numbers">@Model.listaRegistros.Where(x => x.facb_estado == false).Count()</span>
                        <span class="count-name">Rechazados</span>
                    }
                    else
                    {
                        <span class="count-numbers">@Model.listaRegistros.Where(x => x.facb_estado == false).Count()</span>
                        <span class="count-name">Rechazados</span>
                    }
                </div>
            </div>

            <div class="col-xl-3 col-lg-3 col-md-12">
                <div class="card-counter success">
                    <i class="fa fa-database"></i>
                    <span class="count-numbers">@Model.listaRegistros.Count</span>
                    <span class="count-name">Correos</span>
                </div>
            </div>

            <div class="col-xl-3 col-lg-3 col-md-12">
                <div class="card-counter info">
                    <i class="fa fa-users"></i>
                    @if (User.IsInRole("Administrador"))
                    {
                        <span class="count-text font-weight-bold">Administrador</span>
                        <span class="count-name">Rol</span>
                    }
                    else
                    {
                        <span class="count-text font-weight-bold">Usuario</span>
                        <span class="count-name">Rol</span>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- User message -->
    <div class="container">
        <div class="col">
            <div class="card mb-3">
                <figure><img src="/images/dashboard-img.svg" class="card-img-top d-none d-sm-block pt-2" alt="dashboard-image" height="250" width="308"></figure>
                <div class="card-body">
                    <h3 class="card-title text-center">¡Bienvenido de vuelta!</h3>
                    <p class="card-text lead responsive-font-example-p">Hola, <b>¡@User.Identity.Name!</b></p>
                    <p class="card-text">
                        <small class="text-muted">
                            <i class="far fa-calendar-alt"></i> @DateTime.Now
                        </small>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Sub-título -->
    <div class="container">
        <h2 class="text-center text-dark p-2 bg-white headings__boxshadow--dark">Mis correos</h2>
    </div>

    <!-- Datatable -->
    <div class="container border p-3 mb-3 mt-3">
        <div class="row">
            <div class="col-lg-12">
                <div class="table-responsive table-hover">
                    <form method="post">
                        <button class="btn btn-custom-2 btn-primary btn-sm float-right" asp-action="GetCorreos"><i class="fas fa-clipboard-list" title="Cargar registros"></i><span class="hidden-small"> Cargar datos</span></button>
                    </form>
                    <table id="myTable" class="table table-striped table-bordered dt-responsive nowrap w-100">
                        <thead class="text-center">
                            <tr>
                                <th>Id</th>
                                <th>Fecha creación</th>
                                <th>Fecha de actualización</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody class="text-center">
                            @foreach (var item in Model.listaRegistros)
                            {
                                <tr>
                                    <th>
                                        @item.facn_id
                                    </th>
                                    <th>
                                        @item.facd_fechacreacion
                                    </th>
                                    <th>
                                        @item.facd_fechaactualizacion
                                    </th>
                                    <th>
                                        <!-- Ver detalles -->
                                        <div class="container">
                                            <div class="row no-gutters">
                                                <div class="col">
                                                    <form class="form" method="post">
                                                        <button type="submit" class="btn btn-custom btn-primary" data-toggle="modal" asp-action="VerDetallado" asp-route-id="@item.facn_id">
                                                            <i class="far fa-eye" title="Detalles"></i><span class="hidden-small">  Detalles</span>
                                                        </button>
                                                    </form>
                                                </div>
                                                <div class="col">
                                                    <!-- Borrar -->
                                                    <button type="button" class="btn btn-custom btn-danger" data-toggle="modal" data-target="#modalBorrar">
                                                        <i class="fas fa-trash-alt" title="Borrar"></i><span class="hidden-small"> Borrar</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </th>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->

    <div class="modal fade" id="modalDetalles" tabindex="-1" role="dialog" aria-labelledby="modalDetallesLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable" role="document">
            <div class="modal-content">
                <div class="modal-header bg-primary rounded-0">
                    <h5 class="modal-title text-white" id="modalDetallesLabel">Descripción</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
                        <span class="text-white" aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    @if (@Model.registroModal != null)
                    {
                        <p class="lead"><i class="fas fa-list-ol"></i> ID:</p>
                        <div class="container"><p>@Model.registroModal.facn_id </p></div>
                        <p class="lead"><i class="far fa-clock"></i> Fecha de creación:</p>
                        <div class="container"><p>@Model.registroModal.facd_fechacreacion </p></div>
                        <p class="lead"><i class="fas fa-angle-double-left"></i> De:</p>
                        <div class="container"><p> @Model.registroModal.facc_desde</p></div>
                        <p class="lead"><i class="fas fa-angle-double-right"></i> Para:</p>
                        <div class="container"><p> @Model.registroModal.facc_para</p></div>
                        <p class="lead"><i class="fas fa-envelope-open-text"></i> Asunto:</p>
                        <div class="container"><p class="text-justify">@Model.registroModal.facc_descripcion</p></div>
                    }
                    else
                    {
                        <p>No existe información...  </p>
                    }

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom-2 btn-primary">Ver pdf</button>
                    <button type="button" class="btn btn-custom-2 btn-outline-primary" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="modalBorrar" tabindex="-1" role="dialog" aria-labelledby="modalBorrarLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-danger rounded-0">
                    <h5 class="modal-title text-white" id="modalBorrarLabel">¿Eliminar?</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
                        <span class="text-white" aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="lead">¿Estas seguro de querer borrar este elemento?</p>
                    <p class="text-muted">Esta acción es irreversible</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-custom-2 btn-danger" id="btnBorrarModal" data-dismiss="modal">Borrar</button>
                    <button type="button" class="btn btn-custom-2 btn-outline-danger" data-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    @section Scripts {
        <script type="text/javascript">
	// llamar al dataTable
	$(document).ready(function () {
		var table = $('#myTable').DataTable({
			"language": {
				"url": "//cdn.datatables.net/plug-ins/1.11.3/i18n/es_es.json"
			},
			responsive: true,
			dom: 'lfBrtip',
			buttons: [
				{
					extend: 'copyHtml5',
					text: '<i class="fas fa-copy"></i><span class="hidden-small"> Copiar</span>',
					titleAttr: 'Copiar al portapapeles',
					className: 'btn btn-custom btn-primary'
				},
				{
					extend: 'excelHtml5',
					text: '<i class="fas fa-file-excel"></i><span class="hidden-small"> Excel</span>',
					titleAttr: 'Exportar a Excel',
					className: 'btn btn-custom btn-success'
				},
				{
					extend: 'csvHtml5',
					text: '<i class="fas fa-file-csv"></i><span class="hidden-small"> CSV</span>',
					titleAttr: 'Exportar a CSV',
					className: 'btn btn-custom btn-success'
				},
				{
					extend: 'pdfHtml5',
					text: '<i class="fas fa-file-pdf"></i><span class="hidden-small"> PDF</span>',
					titleAttr: 'Exportar a PDF',
					className: 'btn btn-custom btn-danger'
				},
				{
					extend: 'print',
					text: '<i class="fa fa-print"></i><span class="hidden-small"> Imprimir</span>',
					titleAttr: 'Imprimir',
					className: 'btn btn-custom btn-info'
				},
				{
					extend: 'colvis',
					text: '<i class="fas fa-eye"></i><span class="hidden-small"> Mostrar</span>',
					titleAttr: 'Visibilidad'
				}
			]
		});

		new $.fn.dataTable.FixedHeader(table);

		  if ('@Html.Raw(@Model.registroModal)' != '' && '@Html.Raw(@Model.registroModal)' != null && '@Html.Raw(@Model.registroModal)' != undefined)
		  {
			  $("#modalDetalles").modal();
		  }

	});
        </script>
        <!-- SweetAlert -->
        <script type="text/javascript">

            $('#btnBorrarModal').click(function () {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'bottom-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })

                Toast.fire({
                    icon: 'success',
                    title: 'Elemento borrado'
                });
            });
        </script>
    }

}
else
{

    <!-- Carousel - Header-->
    <div id="carouselIndex" class="carousel slide d-none d-lg-block" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselIndex" data-slide-to="0" class="active"></li>
            <li data-target="#carouselIndex" data-slide-to="1"></li>
            <li data-target="#carouselIndex" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <div class="mask flex-center">
                    <div class="container">
                        <div class="row align-items-center p-lg-5">
                            <div class="col-md-7 col-12 order-md-1 order-2">
                                <h4 class="text-white display-3">
                                    ¡Bienvenido!
                                </h4>
                                <p class="text-white">
                                    ¡Hola!, esta es la página de inicio<br>
                                    ¿quieres conocer los detalles de la aplicación?.
                                </p>
                                <a class="btn btn-custom btn-light btn-lg" href="#scroll">¡Ver más!</a>
                            </div>
                            <div class="col-md-5 col-12 order-md-2 order-1"><figure><img src="/images/carousel-img-final-1.svg" class="mx-auto custom-size" alt="slide"></figure></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="mask flex-center">
                    <div class="container">
                        <div class="row align-items-center p-lg-5">
                            <div class="col-lg-7 col-md-7 col-12 order-md-1 order-2">
                                <h4 class="text-white display-3">
                                    ¡Descarga! 
                                </h4>
                                <p class="text-white">
                                    Accede a los adjuntos de tu bandeja de entrada<br>
                                    Recuerda que debes usar una cuenta de Gmail
                                </p>
                            </div>
                            <div class="col-lg-5 col-md-5 col-12 order-md-2 order-1"><figure><img src="/images/carousel-img-final-2.svg" class="mx-auto custom-size" alt="slide"></figure></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <div class="mask flex-center">
                    <div class="container">
                        <div class="row align-items-center p-lg-5">
                            <div class="col-lg-7 col-md-7 col-12 order-md-1 order-2">
                                <h4 class="text-white display-3">
                                    ¡Crea una cuenta!
                                </h4>
                                <p class="text-white">
                                    ¡Podrás crear una cuenta, solo recuerda<br>
                                    que debe ser a través de Gmail!
                                </p>
                            </div>
                            <div class="col-lg-5 col-md-5 col-12 order-md-2 order-1"><figure><img src="/images/carousel-img-final-3.svg" class="mx-auto custom-size" alt="slide"></figure></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselIndex" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Anterior</span>
        </a>
        <a class="carousel-control-next" href="#carouselIndex" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Siguiente</span>
        </a>
    </div>
    <!--slide end-->
    <!-- Content section 1-->
    <section id="scroll">
        <div class="container px-5">
            <div class="row gx-5 align-items-center">
                <div class="col-lg-6 order-lg-2">
                    <div class="p-5"><figure><img class="img-fluid rounded-circle section__border-shadow" src="/images/index-image-4.svg" alt="Index image-1" id="index-image-1" /></figure></div>
                </div>
                <div class="col-lg-6 order-lg-1 border mb-md-5 mb-sm-5 section__description--shadow">
                    <div class="p-sm-5">
                        <h2 class="font-weight-bold responsive-font-example">Ten el control</h2><br />
                        <h5 class="d-none d-md-block"><b>¿Quieres tener un registro de tus facturas?</b></h5>
                        <p class="text-justify responsive-font-example-p">Con las opciones de manejo de tus facturas, podras llevar un registro del estado de tus facturas.<br /> Podras visualizar los precios de las distintas facturas, enviarlas y manipularlas de acuerdo a tus necesidades</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Content section 2-->
    <section id="section-2">
        <div class="custom-shape-divider-bottom-1635297574">
            <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none">
                <path d="M1200 120L0 16.48 0 0 1200 0 1200 120z" class="shape-fill"></path>
            </svg>
        </div>
        <div class="container px-5">
            <div class="row gx-5 align-items-center">
                <div class="col-lg-6">
                    <div class="p-5"><figure><img class="img-fluid rounded-circle section__border-shadow" src="/images/index-img-2.svg" alt="Index image-2"></figure></div>
                </div>
                <div class="col-lg-6 my-xl-auto my-lg-2 my-md-2 mb-sm-2 border bg-white section__description--shadow">
                    <div class="p-sm-5">
                        <h2 class="display-4 font-weight-bold responsive-font-example">¡Manipula tus facturas!</h2><br />
                        <h5 class="d-none d-md-block"><b>¿Deseas revisar a detalle tus facturas?</b></h5>
                        <p class="text-justify responsive-font-example-p">Utilizando las opciones de manipulación puedes revisar a detalle tus facturas y aceptarlas o rechazarlas, además de poder analizarlas a tu gusto</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Content section 3-->
    <section>
        <div class="container px-5">
            <div class="row gx-5 align-items-center">
                <div class="col-lg-6 order-lg-2">
                    <div class="p-5"><figure><img class="img-fluid rounded-circle section__border-shadow" src="/images/index-img-3.svg" alt="Index image-3" /></figure></div>
                </div>
                <div class="col-lg-6 order-lg-1 border mb-md-5 mb-sm-5 section__description--shadow">
                    <div class="p-sm-5">
                        <h2 class="display-4 font-weight-bold responsive-font-example">¿Servicio de mensajería?</h2><br />
                        <p class="text-justify responsive-font-example-p">Para facilitar tu comunicación con los demás usuarios, ¡contaras con el envío y recibo de correos electronicos para agilizar tus procesos de gestión!</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Back to top arrow -->
    <a id="back-to-top" href="#" class="btn btn-outline-primary border-0 btn-xl back-to-top mb-5" role="button" title="Volver arriba"><i class="fas fa-chevron-up"></i></a>
}


